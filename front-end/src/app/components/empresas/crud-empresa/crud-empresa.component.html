<app-header nombre="MANTENIMIENTO DE EMPRESAS" icono="city"></app-header>

<br><br>

<mat-horizontal-stepper linear #stepper>
	<mat-step completed="false">
		<ng-template matStepLabel>{{ titulo }} <span *ngIf="id">: {{ form.razon_social }}</span></ng-template>
		<div class="row data-crud">
			<div class="col-12">
				<form (ngSubmit)="guardar()" class="px-4" [formGroup]="formEmpresa" novalidate="" ngNativeValidate>
					<div class="row">
						<div class="col-6">
							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Ruc <span
										class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" name="nroruc" class="form-control" formControlName="nroruc" [ngClass]="{'is-invalid': !formEmpresa.get('nroruc').valid}" [(ngModel)]="form.nro_ruc"
										required>
									<div *ngIf="formEmpresa.controls['nroruc'].errors?.required" class="invalid-feedback">
										El número de ruc es necesario
									</div>
									<div *ngIf="formEmpresa.controls['nroruc'].errors?.minlength" class="invalid-feedback">
										Por lo menos 11 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nroruc'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 11 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nroruc'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Razón Social <span
										class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" name="razonsocial" class="form-control" formControlName="razonsocial" [ngClass]="{'is-invalid': !formEmpresa.get('razonsocial').valid}" [(ngModel)]="form.razon_social"
										required>
									<div *ngIf="formEmpresa.controls['razonsocial'].errors?.required" class="invalid-feedback">
										La razón social es necesario
									</div>
									<div *ngIf="formEmpresa.controls['razonsocial'].errors?.minlength" class="invalid-feedback">
										Por lo menos 3 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['razonsocial'].errors?.pattern" class="invalid-feedback">
										Escribir solo letras
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Página Web </label>
								<div class="col-sm-8">
									<input type="text" name="pagweb" class="form-control" formControlName="pagweb" [ngClass]="{'is-invalid': !formEmpresa.get('pagweb').valid}" [(ngModel)]="form.pag_web">
									<div *ngIf="formEmpresa.controls['pagweb'].errors?.pattern" class="invalid-feedback">
										Formato de página web no válido
								</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Dirección <span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" name="direccion" class="form-control" formControlName="direccion" [ngClass]="{'is-invalid': !formEmpresa.get('direccion').valid}" [(ngModel)]="form.direccion" required>
									<div *ngIf="formEmpresa.controls['direccion'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 250 caracteres
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Ubigeo <span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<mat-form-field class="example-full-width w-100">
										<input type="text" [(ngModel)]="form.ubigeo_id" matInput name="ubigeo_id" class="form-control"
											   [formControl]="myControl" [matAutocomplete]="auto" required (keyup)="limpiarAutocomplete($event)">
										<mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" (optionSelected)="cargarUbigeo($event)">
											<mat-option *ngFor="let option of filteredUbigeo | async" [value]="option">
												{{option.departamento}} {{option.provincia}} {{option.distrito}}
											</mat-option>
										</mat-autocomplete>
									</mat-form-field>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Teléfono Fijo </label>
								<div class="col-sm-8">
									<input type="text" name="telf" class="form-control" formControlName="telf" [ngClass]="{'is-invalid': !formEmpresa.get('telf').valid}" [(ngModel)]="form.telf_fijo">
									<div *ngIf="formEmpresa.controls['telf'].errors?.minlength" class="invalid-feedback">
										Por lo menos 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Celular <span
									class="text-danger">*</span></label>
								<div class="col-sm-8">
									<input type="text" name="nrocel" class="form-control" formControlName="nrocel" [ngClass]="{'is-invalid': !formEmpresa.get('nrocel').valid}" [(ngModel)]="form.nro_celular" required>
									<div *ngIf="formEmpresa.controls['nrocel'].errors?.required" class="invalid-feedback">
										El número de celular es necesario
									</div>
									<div *ngIf="formEmpresa.controls['nrocel'].errors?.minlength" class="invalid-feedback">
										Por lo menos 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nombre de Contacto 1 </label>
								<div class="col-sm-8">
									<input type="text" name="nomcont1" class="form-control" formControlName="nomcont1" [ngClass]="{'is-invalid': !formEmpresa.get('nomcont1').valid}" [(ngModel)]="form.nombre_contacto1">
									<div *ngIf="formEmpresa.controls['nomcont1'].errors?.minlength" class="invalid-feedback">
										Por lo menos 3 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nomcont1'].errors?.pattern" class="invalid-feedback">
										Escribir solo letras
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Telefono Fijo 1 </label>
								<div class="col-sm-8">
									<input type="text" name="telf1" class="form-control" formControlName="telf1" [ngClass]="{'is-invalid': !formEmpresa.get('telf1').valid}" [(ngModel)]="form.telf_fijo1">
									<div *ngIf="formEmpresa.controls['telf1'].errors?.minlength" class="invalid-feedback">
										Por lo menos 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf1'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf1'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Celular 1 </label>
								<div class="col-sm-8">
									<input type="text" name="nrocel1" class="form-control" formControlName="nrocel1" [ngClass]="{'is-invalid': !formEmpresa.get('nrocel1').valid}" [(ngModel)]="form.nro_celular1">
									<div *ngIf="formEmpresa.controls['nrocel1'].errors?.minlength" class="invalid-feedback">
										Por lo menos 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel1'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel1'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>
						</div>

						<div class="col-6">
							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Correo de Contacto 1 </label>
								<div class="col-sm-8">
									<input type="email" name="emailcont1" class="form-control" formControlName="emailcont1" [ngClass]="{'is-invalid': !formEmpresa.get('emailcont1').valid}" [(ngModel)]="form.email_contacto1">
									<div *ngIf="formEmpresa.controls['emailcont1'].errors?.pattern" class="invalid-feedback">
										Formato de correo no válido
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nombre de Contacto 2</label>
								<div class="col-sm-8">
									<input type="text" name="nomcont2" class="form-control" formControlName="nomcont2" [ngClass]="{'is-invalid': !formEmpresa.get('nomcont2').valid}" [(ngModel)]="form.nombre_contacto2">
									<div *ngIf="formEmpresa.controls['nomcont2'].errors?.minlength" class="invalid-feedback">
										Por lo menos 3 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nomcont2'].errors?.pattern" class="invalid-feedback">
										Escribir solo letras
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Teléfono Fijo 2</label>
								<div class="col-sm-8">
									<input type="text" name="telf2" class="form-control" formControlName="telf2" [ngClass]="{'is-invalid': !formEmpresa.get('telf2').valid}" [(ngModel)]="form.telf_fijo2">
									<div *ngIf="formEmpresa.controls['telf2'].errors?.minlength" class="invalid-feedback">
										Por lo menos 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf2'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 7 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['telf2'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Celular 2</label>
								<div class="col-sm-8">
									<input type="text" name="nrocel2" class="form-control" formControlName="nrocel2" [ngClass]="{'is-invalid': !formEmpresa.get('nrocel2').valid}" [(ngModel)]="form.nro_celular2">
									<div *ngIf="formEmpresa.controls['nrocel2'].errors?.minlength" class="invalid-feedback">
										Por lo menos 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel2'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 9 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocel2'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Correo de Contacto 2</label>
								<div class="col-sm-8">
									<input type="email" name="emailcont2" class="form-control" formControlName="emailcont2" [ngClass]="{'is-invalid': !formEmpresa.get('emailcont2').valid}" [(ngModel)]="form.email_contacto2">
									<div *ngIf="formEmpresa.controls['emailcont2'].errors?.pattern" class="invalid-feedback">
										Formato de correo no válido
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nombre de Banco </label>
								<div class="col-sm-8">
									<input type="text" name="nombanco" class="form-control" formControlName="nombanco" [ngClass]="{'is-invalid': !formEmpresa.get('nombanco').valid}" [(ngModel)]="form.nombre_banco">
									<div *ngIf="formEmpresa.controls['nombanco'].errors?.minlength" class="invalid-feedback">
										Por lo menos 3 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nombanco'].errors?.pattern" class="invalid-feedback">
										Escribir solo letras
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Cuenta </label>
								<div class="col-sm-8">
									<input type="text" name="nrocta" class="form-control" formControlName="nrocta" [ngClass]="{'is-invalid': !formEmpresa.get('nrocta').valid}" [(ngModel)]="form.nro_cta">
									<div *ngIf="formEmpresa.controls['nrocta'].errors?.minlength" class="invalid-feedback">
										Por lo menos 12 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocta'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 14 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nrocta'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Nro de Cuenta Interbancaria </label>
								<div class="col-sm-8">
									<input type="text" name="nroctainter" class="form-control" formControlName="nroctainter" [ngClass]="{'is-invalid': !formEmpresa.get('nroctainter').valid}" [(ngModel)]="form.nro_cta_interbancaria">
									<div *ngIf="formEmpresa.controls['nroctainter'].errors?.minlength" class="invalid-feedback">
										Por lo menos 20 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nroctainter'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 20 caracteres
									</div>
									<div *ngIf="formEmpresa.controls['nroctainter'].errors?.pattern" class="invalid-feedback">
										Escribir solo números
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row my-3">
								<label class="col-sm-4 col-form-label w-100">Observaciones</label>
								<div class="col-sm-8">
									<textarea type="text" name="obs" class="form-control" formControlName="obs" [ngClass]="{'is-invalid': !formEmpresa.get('obs').valid}" [(ngModel)]="form.observaciones"></textarea>
									<div *ngIf="formEmpresa.controls['obs'].errors?.maxlength" class="invalid-feedback">
										Por lo máximo 250 caracteres
									</div>
								</div>
								<hr>
							</div>

							<div class="form-group row mt-5">
								<div class="col-12">
									<button type="submit" class="btn btn-success">GUARDAR</button>
									<a routerLink="/empresas" class="btn btn-info">REGRESAR A LA LISTA</a>
								</div>
							</div>
						</div>
					</div>
				</form>
			</div>
			<div class="col-5" *ngIf="id==null">
				<div class="form-check my-3">
					<input type="checkbox" [(ngModel)]="generarSucursal" [ngModelOptions]="{standalone: true}">
					<label class="form-check-label" for="exampleCheck">Sedes</label>
				</div>
			</div>
			<div class="col-5 p-0 widget clearfix" *ngIf="id">
				<app-auditoria [form]="form"></app-auditoria>
			</div>
		</div>
	</mat-step>
	<mat-step [stepControl]="secondFormGroup">
		<ng-template matStepLabel>SEDES</ng-template>
		<app-sucursal [id]="id"></app-sucursal>
		<div class="form-group row mt-3">
			<div class="col-12">
				<a routerLink="/empresas" class="btn btn-info">REGRESAR A LA LISTA</a>
			</div>
		</div>
	</mat-step>
</mat-horizontal-stepper>
